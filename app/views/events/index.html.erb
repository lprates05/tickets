<!-- app/views/events/index.html.erb -->
<h1>All Events</h1>



<div style="display: flex; flex-wrap: wrap; gap: 2rem;">
  <% @events.each do |event| %>
    <div style="border: 1px solid #ccc; border-radius: 8px; padding: 1rem; width: 300px;">
      
      <% if event.event_photo.attached? %>
        <%= image_tag event.event_photo, class: "card-img-top", style: "height: 200px; object-fit: cover;" %>
      <% else %>
        <%= image_tag "https://via.placeholder.com/400x300?text=No+Image", class: "card-img-top", style: "height: 200px; object-fit: cover;" %>
      <% end %>

      <h2>
        <%= link_to event.name, event_path(event), style: "text-decoration: none; color: inherit;" %>
      </h2>
      <p><strong>Category:</strong> <%= event.category %></p>
      <p><strong>Date:</strong> <%= event.start_date %> to <%= event.end_date %></p>
      <p><strong>Time:</strong> <%= event.start_time.strftime("%I:%M %p") %> - <%= event.end_time.strftime("%I:%M %p") %> 

      <% available_tickets = event.tickets.where(buyer_id: nil) %>
      <% if available_tickets.any? %>
        <%= link_to "View Tickets (#{available_tickets.count})", tickets_path(event_id: event.id), style: "display: inline-block; margin-top: 0.5rem; background: #007bff; color: white; padding: 0.5rem 1rem; border-radius: 4px; text-decoration: none;" %>
      <% else %>
        <p style="color: gray;">No tickets available</p>
      <% end %>

       <% if current_user&.admin? %>
          <div class="d-flex justify-content-between">
            <%= link_to "Edit", edit_event_path(event), class: "btn btn-sm btn-warning" %>
            <%= link_to "Delete", event_path(event), method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-sm btn-danger" %>
          </div>
        <% end %>      
    </div>
  <% end %>
</div>
